---
title: "sample size determination"
output: 
  workflowr::wflow_html:
    code_folding: hide
    toc: true
date: "2025-08-01"
---


```{r, message=F, warning=F}
library(ggplot2)
```




```{r, message=F, warning=F}

# Sample size function
sample_size_proportion <- function(p, margin_error, population, z_score = 1.96){
  q <- 1 - p
  z2 <- (z_score)^2
  d2 <- margin_error^2
  N <- (p * q * z2) / d2 
  n <- N / (1 + (N / population))
  
  return(min(N,n))
}

```






```{r, message=F, warning=F}
# Set up
p <- 1091 / 30498
population <- 30498
relative_errors <- seq(0.1, 1, by = 0.1)  # 10% to 100% of p
margin_errors <- p * relative_errors     # Convert to absolute margin of error


# Calculate sample sizes
sample_sizes <- sapply(margin_errors, function(d) {
  sample_size_proportion(p, margin_error = d, population = population)
})

# Make a data frame for plotting
df <- data.frame(
  Relative_Error = relative_errors,
  Sample_Size = round(sample_sizes)
)

# Draw bar plot with labels on top
ggplot(df, aes(x = factor(Relative_Error), y = Sample_Size)) +
  geom_bar(stat = "identity", fill = "steelblue") +
  geom_text(aes(label = Sample_Size), vjust = -0.5, size = 3) +
  labs(
    title = "Sample Size vs. Relative Margin of Error",
    x = "Margin of Error (as proportion of p)",
    y = "Sample Size"
  ) +
  theme_minimal() +
  theme(
    text = element_text(size = 14),
    plot.title = element_text(hjust = 0.5, face = "bold")
  )

```


* if margin of error is allowed at 20% of the proportion, the sample size would be 2,386.  


## reference 

1. [Organizational Research: Determining
Appropriate Sample Size in Survey Research](https://www.opalco.com/wp-content/uploads/2014/10/Reading-Sample-Size1.pdf)
